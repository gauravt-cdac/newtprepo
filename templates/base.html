{% load bootstrap5 %}
{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{% block title %}Cake Shop{% endblock %}</title>
    {% bootstrap_css %}
    <link rel="stylesheet" href="{% static 'css/custom.css' %}" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
    <style>
        body {
            background: #f6f7fa;
            font-family: system-ui, 'Segoe UI', Arial, sans-serif;
            min-height: 100vh;
        }
        .navbar {
            background: #21242a;
            font-size: 1.02rem;
            border-bottom: 1.5px solid #f2e7b6;
        }
        .navbar .navbar-brand {
            font-family: inherit;
            font-weight: 800;
            font-size: 1.5rem;
            color: #ffd700 !important;
            letter-spacing: 1.1px;
            display: flex;
            align-items: center;
        }
        /* Cake logo svg styling */
        .brand-logo-svg {
            width: 34px;
            height: 34px;
            margin-right: 9px;
            vertical-align: middle;
            fill: #ffd700;
            stroke: #222;
            stroke-width: 1.5;
        }
        .navbar .nav-link, .navbar .dropdown-item {
            color: #ddd !important;
            transition: color 0.12s;
        }
        .navbar .nav-link:hover, .navbar .dropdown-item:hover {
            color: #ffd700 !important;
            background: none;
        }
        main.container {
            background: #fff;
            border-radius: 1.2rem;
            max-width: 950px;
            box-shadow: 0 4px 30px rgba(17,28,46,0.08);
            margin-bottom: 2rem;
            margin-top: 2.2rem;
            padding: 1.6rem 1.15rem 1.2rem 1.15rem;
        }
        .footer-main {
            background: #22252e;
            color: #d9def1;
            font-size: 0.98em;
            border-top: 2.5px solid #ffd700;
            padding-top: 2.5rem;
            padding-bottom: 1.1rem;
        }
        .footer-cols {
            display: flex;
            flex-wrap: wrap;
            gap: 32px 28px;
            justify-content: space-between;
        }
        .footer-col {
            min-width: 135px;
        }
        .footer-brand {
            font-weight: 700;
            font-size: 1.19rem;
            color: #fff;
            letter-spacing: 0.7px;
            margin-bottom: 0.35rem;
            display: flex;
            align-items: center;
        }
        .footer-col-title {
            color: #ffd700;
            font-weight: 500;
            font-size: 1em;
            margin-bottom: 0.65rem;
        }
        .footer-link, .footer-link:hover, .footer-link:focus {
            color: #d9def1;
            text-decoration: none;
        }
        .footer-link:hover { color: #ffd700; }
        .footer-social .fa-brands, .footer-social .fa-solid {
            font-size: 1.15rem;
            margin-right: 15px;
            color: #ffd700;
            transition: color 0.15s;
        }
        .footer-social .fa-brands:hover { color: #fff7aa; }
        .payment-logos {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            align-items: center;
        }
        .payment-logos svg {
            background: #fff;
            border-radius: 7px;
            box-shadow: 0 1px 6px #0001;
            height: 30px;
            width: 55px;
            padding: 4px 8px;
        }
        .footer-bottom {
            font-size: .98em;
            color: #bdbdbd;
            border-top: 1.2px solid #414862;
            margin-top: 1.15rem; padding-top: 0.7rem;
            text-align: center;
        }
        /* Dropdown menu customization: darker and more visible */
        .dropdown-menu {
            background-color: #1e2127 !important;
            color: #ddd !important;
            border-radius: 0.75rem !important;
            box-shadow: 0 6px 15px rgba(0,0,0,0.35) !important;
            min-width: 190px !important;
            font-weight: 500;
        }
        .dropdown-menu a.dropdown-item {
            color: #ddd !important;
            padding: 0.55rem 1.15rem !important;
        }
        .dropdown-menu a.dropdown-item:hover,
        .dropdown-menu a.dropdown-item:focus {
            background-color: #ffd700 !important;
            color: #222 !important;
            outline: none !important;
        }
        @media (max-width: 900px) { main.container { max-width: 99vw; padding: 1.1rem 0.4rem 0.7rem 0.4rem; } }
        @media (max-width: 768px) { .footer-cols { flex-direction:column; gap:20px;} .footer-col { min-width: 0; } }
    </style>
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark sticky-top py-2 shadow-sm">
    <div class="container">
        <a class="navbar-brand py-0 d-flex align-items-center" href="{% url 'home' %}">
            <!-- Classic cake icon SVG -->
            <svg class="brand-logo-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" fill="none" stroke="#222" stroke-width="2" stroke-linejoin="round" stroke-linecap="round">
                <circle cx="32" cy="32" r="30" fill="#ffd700"/>
                <path d="M16 44h32v6a2 2 0 0 1-2 2H18a2 2 0 0 1-2-2v-6z" fill="#fff"/>
                <path d="M16 44l16-22 16 22" fill="none" stroke="#222" stroke-width="3"/>
                <circle cx="32" cy="15" r="5" fill="#fff" stroke="#222" stroke-width="2"/>
            </svg>
            Cake Shop
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false"
                aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse pt-1" id="navbarNav">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'cake_list' %}">Cakes</a>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="categoriesDropdown" role="button"
                       data-bs-toggle="dropdown" aria-expanded="false">Categories</a>
                    <ul class="dropdown-menu" aria-labelledby="categoriesDropdown">
                        {% for category in categories %}
                            <li>
                                <a class="dropdown-item" href="{% url 'cake_list' %}?category={{ category.id }}">
                                    {{ category.name }}
                                </a>
                            </li>
                        {% endfor %}
                    </ul>
                </li>
            </ul>
            <form class="d-flex me-lg-3 mb-2 mb-lg-0" method="GET" action="{% url 'cake_list' %}" role="search">
                <input class="form-control me-2" type="search" name="search" placeholder="Search cakes..."
                       aria-label="Search cakes" value="{{ request.GET.search }}" />
                <button class="btn btn-warning" style="font-weight:600;" type="submit" aria-label="Search">
                    <i class="fas fa-search"></i>
                </button>
            </form>
            <ul class="navbar-nav mb-2 mb-lg-0">
                {% if user.is_authenticated %}
                    <li class="nav-item position-relative pe-2">
                        <a class="nav-link" href="{% url 'cart_detail' %}" aria-label="View Cart">
                            <i class="fas fa-shopping-cart fa-lg"></i>
                            <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" id="cart-count">
                                {% if user.cart.get_total_items %}{{ user.cart.get_total_items }}{% else %}0{% endif %}
                            </span>
                        </a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" role="button"
                           id="userDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="fas fa-user me-1"></i> {{ user.get_full_name|default:user.username }}
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
                            {% if user.role == 'admin' %}
                                <li><a class="dropdown-item" href="{% url 'admin_dashboard' %}">Admin Dashboard</a></li>
                            {% elif user.role == 'seller' %}
                                <li><a class="dropdown-item" href="{% url 'seller_dashboard' %}">Seller Dashboard</a></li>
                            {% endif %}
                            <li><a class="dropdown-item" href="{% url 'profile' %}">My Profile</a></li>
                            <li><a class="dropdown-item" href="{% url 'order_list' %}">My Orders</a></li>
                            <li><hr class="dropdown-divider" /></li>
                            <li><a class="dropdown-item" href="{% url 'logout' %}">Logout</a></li>
                        </ul>
                    </li>
                {% else %}
                    <li class="nav-item pe-1">
                        <a class="nav-link" href="{% url 'login' %}">Login</a>
                    </li>
                    <li class="nav-item pe-1">
                        <a class="nav-link" href="{% url 'register' %}">Register</a>
                    </li>
                {% endif %}
            </ul>
        </div>
    </div>
</nav>
{% if messages %}
    <div class="container mt-3">
        {% for message in messages %}
            <div class="alert alert-{{ message.tags }} alert-dismissible fade show shadow-sm py-2 px-3" role="alert">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        {% endfor %}
    </div>
{% endif %}
<main class="container my-4" role="main">
    {% block content %}{% endblock %}
</main>
<footer class="footer-main">
    <div class="container pb-3">
        <div class="footer-cols">
            <div class="footer-col">
                <div class="footer-brand mb-2">
                    <span class="cake-emoji" style="font-size:1.35em; margin-right: 6px;">🎂</span>
                    Cake Shop
                </div>
                <div class="mb-2" style="max-width:260px;">
                    Freshly baked happiness for every occasion, delivered at your doorstep.
                </div>
                <div class="footer-social mb-3 mt-1">
                     <a href="mailto:cdacnashikk@gmail.com" aria-label="Email"><i class="fa-solid fa-envelope"></i></a>
                     <a href="tel:+917709643425" aria-label="Phone"><i class="fa-solid fa-phone"></i></a>
                     <a href="https://wa.me/7709643425" target="_blank" aria-label="WhatsApp" style="color: #ffc107;">
    <i class="fab fa-whatsapp"></i>
</a>

                </div>
            </div>
            
            <div class="footer-col">
                <div class="footer-col-title">Contact Us </div>
                <p class="mb-1">
                    <i class="fa-solid fa-envelope text-warning"></i>
                    <a href="mailto:support@cakeshop.com" class="footer-link">&nbsp support@cakeshop.com</a>
                </p>
                <p class="mb-1">
                    <i class="fa-solid fa-phone text-success"></i>
                    <a href="tel:+919876543210" class="footer-link">   +(91)   7709643425</a>
                </p>
                <p class="mb-1"><span class="fa-solid fa-map-marker-alt text-danger"></span>   &nbsp Khamgaon, India</p>
            </div>
            <div class="footer-col">
                <div class="footer-col-title">We Accept</div>
                <div class="payment-logos mb-2" aria-label="Payment methods">
                    <!-- Visa SVG -->
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 55 30" aria-hidden="true" role="img" focusable="false">
                        <rect width="55" height="30" rx="7" fill="#fff" />
                        <text x="12" y="20" fill="#1a1f71" font-family="Verdana" font-size="14" font-weight="bold">VISA</text>
                    </svg>
                    <!-- Mastercard SVG -->
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 55 30" aria-hidden="true" role="img" focusable="false">
                        <rect width="55" height="30" rx="7" fill="#fff"/>
                        <ellipse cx="20" cy="15" rx="9" ry="9" fill="#eb001b"/>
                        <ellipse cx="34" cy="15" rx="9" ry="9" fill="#f79e1b"/>
                        <ellipse cx="27" cy="15" rx="9" ry="9" fill="#fff3"/>
                    </svg>
                    <!-- Razorpay SVG -->
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 55 30" aria-hidden="true" role="img" focusable="false">
                        <rect width="55" height="30" rx="7" fill="#fff" />
                        <text x="8" y="19" fill="#387ef5" font-family="Verdana" font-size="12" font-weight="bold">RAZORPAY</text>
                    </svg>
                    <!-- Paytm SVG -->
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 55 30" aria-hidden="true" role="img" focusable="false">
                        <rect width="55" height="30" rx="7" fill="#fff" />
                        <text x="12" y="20" fill="#00baf2" font-family="Verdana" font-size="14" font-weight="bold">PAYTM</text>
                    </svg>
                    <!-- UPI SVG -->
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 55 30" aria-hidden="true" role="img" focusable="false">
                        <rect width="55" height="30" rx="7" fill="#fff" />
                        <text x="10" y="20" fill="#057642" font-family="Verdana" font-size="14" font-weight="bold">UPI</text>
                    </svg>
                </div>
                <span class="small d-block mt-2" style="color:#bdbdbd;">All major cards, UPI, and COD supported.</span>
            </div>
        </div>
         
        <div class="footer-bottom mt-4">
            Made with ❤️ by Gaurav Takalkar <hr> 
            &copy; 2024 <b>Cake Shop</b>. 
            
            
        </div>
    </div>
</footer>
{% bootstrap_javascript %}
<script>
    function addToCart(variantId, quantity = 1) {
        fetch("{% url 'add_to_cart' %}", {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded',
                'X-CSRFToken': '{{ csrf_token }}'
            },
            body: `variant_id=${variantId}&quantity=${quantity}`
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                document.getElementById('cart-count').textContent = data.cart_count;
                showToast(data.message, 'success');
            } else {
                showToast(data.message, 'error');
            }
        })
        .catch(error => {
            showToast('Something went wrong!', 'error');
        });
    }
    function showToast(message, type) {
        const toast = document.createElement('div');
        toast.className = `toast align-items-center text-white bg-${type === 'success' ? 'success' : 'danger'} border-0 position-fixed bottom-0 end-0 m-3`;
        toast.style.zIndex = 1080;
        toast.setAttribute('role', 'alert');
        toast.setAttribute('aria-live', 'assertive');
        toast.setAttribute('aria-atomic', 'true');
        toast.innerHTML = `
            <div class="d-flex">
                <div class="toast-body">${message}</div>
                <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
        `;
        document.body.appendChild(toast);
        const bsToast = new bootstrap.Toast(toast, { delay: 4000 });
        bsToast.show();
        toast.addEventListener('hidden.bs.toast', () => {
            document.body.removeChild(toast);
        });
    }
</script>
{% block extra_js %}{% endblock %}
</body>
</html>
